import socket
import time

global server_address

MYPORT = 50000

def try_connecting():
    start = time.time()
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    s.bind(('', MYPORT))
    s.setblocking(0)
    while time.time() - start < 5:
        try:
            m = s.recvfrom(1024)
            print('Data: ' + m[0].decode('utf-8'))
            if m[0].decode('utf-8') == 'scan':

                start = time.time()
                while time.time() - start < .2:
                    message = bytes("connecting".encode(encoding='utf-8'))
                    s.sendto(message, ('255.255.255.255', MYPORT))

                global server_address
                server_address = m[1]

                s.close()
                return True
        except socket.error:
            pass
    s.close()
    return False
